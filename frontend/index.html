<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Chat App</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
    <!-- Loading Spinner -->
    <div id="loading" class="loading-overlay">
        <div class="spinner"></div>
        <p>ƒêang t·∫£i...</p>
    </div>

    <!-- Auth Container (Login/Register) -->
    <div id="auth-container" class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>üí¨ Real-time Chat</h1>
                <div class="auth-tabs">
                    <button class="tab-btn active" data-tab="login">ƒêƒÉng nh·∫≠p</button>
                    <button class="tab-btn" data-tab="register">ƒêƒÉng k√Ω</button>
                </div>
            </div>

            <!-- Login Form -->
            <div id="login-form" class="auth-form active">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="login-username">T√™n ƒëƒÉng nh·∫≠p</label>
                        <input type="text" id="login-username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">M·∫≠t kh·∫©u</label>
                        <input type="password" id="login-password" name="password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-sign-in-alt"></i> ƒêƒÉng nh·∫≠p
                    </button>
                </form>
            </div>

            <!-- Register Form -->
            <div id="register-form" class="auth-form">
                <form id="registerForm">
                    <div class="form-group">
                        <label for="register-username">T√™n ƒëƒÉng nh·∫≠p</label>
                        <input type="text" id="register-username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">M·∫≠t kh·∫©u</label>
                        <input type="password" id="register-password" name="password" required>
                    </div>
                    <div class="form-group">
                        <label for="register-confirm-password">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                        <input type="password" id="register-confirm-password" name="confirmPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-user-plus"></i> ƒêƒÉng k√Ω
                    </button>
                </form>
            </div>

            <div class="auth-footer">
                <p id="auth-message" class="message"></p>
            </div>
        </div>
    </div>

    <!-- Main Chat App -->
    <div id="chat-container" class="chat-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="user-info">
                    <div class="avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-details">
                        <h3 id="current-username">User</h3>
                        <span class="status online">Tr·ª±c tuy·∫øn</span>
                    </div>
                    <div class="user-actions">
                        <button id="profile-btn" class="btn-icon" title="Th√¥ng tin c√° nh√¢n">
                            <i class="fas fa-cog"></i>
                        </button>
                        <button id="logout-btn" class="btn-icon" title="ƒêƒÉng xu·∫•t">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Search -->
            <div class="search-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="T√¨m ki·∫øm b·∫°n b√®, tin nh·∫Øn...">
                </div>
            </div>

            <!-- Tabs -->
            <div class="sidebar-tabs">
                <button class="tab-btn active" data-tab="conversations">
                    <i class="fas fa-comments"></i> Tr√≤ chuy·ªán
                </button>
                <button class="tab-btn" data-tab="friends">
                    <i class="fas fa-users"></i> B·∫°n b√®
                </button>
            </div>

            <!-- Conversations List -->
            <div id="conversations-tab" class="tab-content active">
                <div class="section-header">
                    <h4>Cu·ªôc tr√≤ chuy·ªán</h4>
                    <div class="new-chat-dropdown">
                        <button id="new-chat-btn" class="btn-icon" title="Cu·ªôc tr√≤ chuy·ªán m·ªõi">
                            <i class="fas fa-plus"></i>
                        </button>
                        <div id="new-chat-menu" class="dropdown-menu">
                            <button id="new-direct-chat-btn" class="dropdown-item">
                                <i class="fas fa-user"></i> Tr√≤ chuy·ªán ri√™ng
                            </button>
                            <button id="new-group-chat-btn" class="dropdown-item">
                                <i class="fas fa-users"></i> T·∫°o nh√≥m
                            </button>
                        </div>
                    </div>
                </div>
                <div id="conversations-list" class="list">
                    <!-- Conversations will be loaded here -->
                </div>
            </div>

            <!-- Friends List -->
            <div id="friends-tab" class="tab-content">
                <div class="section-header">
                    <h4>B·∫°n b√®</h4>
                    <button id="add-friend-btn" class="btn-icon" title="Th√™m b·∫°n">
                        <i class="fas fa-user-plus"></i>
                    </button>
                </div>
                <div id="friends-list" class="list">
                    <!-- Friends will be loaded here -->
                </div>

                <div class="section-header">
                    <h4>L·ªùi m·ªùi k·∫øt b·∫°n</h4>
                </div>
                <div id="friend-requests-list" class="list">
                    <!-- Friend requests will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Main Chat Area -->
        <div class="main-chat">
            <!-- Chat Header -->
            <div id="chat-header" class="chat-header">
                <div class="chat-info">
                    <div class="avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="chat-details">
                        <h3 id="chat-title">Ch·ªçn cu·ªôc tr√≤ chuy·ªán</h3>
                        <span id="chat-status" class="status">Tr·ª±c tuy·∫øn</span>
                    </div>
                </div>
                <div class="chat-actions">
                    <button class="btn-icon" title="Th√¥ng tin">
                        <i class="fas fa-info-circle"></i>
                    </button>
                    <button id="conversation-settings-btn" class="btn-icon" title="C√†i ƒë·∫∑t">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>

            <!-- Messages Area -->
            <div id="messages-container" class="messages-container">
                <div id="messages-list" class="messages-list">
                    <!-- Messages will be loaded here -->
                </div>
            </div>

            <!-- Message Input -->
            <div id="message-input-container" class="message-input-container">
                <form id="message-form" class="message-form">
                    <div class="input-group">
                        <button type="button" class="btn-icon" title="ƒê√≠nh k√®m">
                            <i class="fas fa-paperclip"></i>
                        </button>
                        <input type="text" id="message-input" placeholder="Nh·∫≠p tin nh·∫Øn..." disabled>
                        <button type="submit" id="send-btn" class="btn-icon send-btn" disabled>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Friend Modal -->
    <div id="add-friend-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Th√™m b·∫°n</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="add-friend-form">
                    <div class="form-group">
                        <label for="friend-username">T√™n ƒëƒÉng nh·∫≠p</label>
                        <input type="text" id="friend-username" placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p..." required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary close-modal">H·ªßy</button>
                        <button type="submit" class="btn btn-primary">G·ª≠i l·ªùi m·ªùi</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- New Chat Modal -->
    <div id="new-chat-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cu·ªôc tr√≤ chuy·ªán m·ªõi</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="friends-for-chat" class="friends-list">
                    <!-- Friends will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Conversation Settings Modal -->
    <div id="conversation-settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>C√†i ƒë·∫∑t cu·ªôc tr√≤ chuy·ªán</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="conversation-settings-form">
                    <div class="form-group">
                        <label for="conversation-name">T√™n cu·ªôc tr√≤ chuy·ªán</label>
                        <input type="text" id="conversation-name" name="name" placeholder="Nh·∫≠p t√™n cu·ªôc tr√≤ chuy·ªán">
                    </div>

                    <div class="form-group">
                        <label>C√†i ƒë·∫∑t quy·ªÅn h·∫°n</label>
                        <div class="settings-options">
                            <label class="checkbox-container">
                                <input type="checkbox" id="allow-member-add" name="allow_member_add">
                                <span class="checkmark"></span>
                                Cho ph√©p th√†nh vi√™n th√™m ng∆∞·ªùi kh√°c
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Th√†nh vi√™n</label>
                        <div class="members-header">
                            <button type="button" id="add-member-btn" class="btn-small btn-primary">
                                <i class="fas fa-user-plus"></i> Th√™m th√†nh vi√™n
                            </button>
                        </div>
                        <div id="conversation-members" class="members-list">
                            <!-- Members will be loaded here -->
                        </div>
                    </div>

                    <!-- Advanced Settings (Group only) -->
                    <div id="advanced-settings" class="form-group" style="display: none;">
                        <label>C√†i ƒë·∫∑t n√¢ng cao</label>
                        <div class="advanced-actions">
                            <div class="action-group">
                                <h5>Chuy·ªÉn quy·ªÅn admin</h5>
                                <p class="help-text">Chuy·ªÉn quy·ªÅn qu·∫£n l√Ω nh√≥m cho th√†nh vi√™n kh√°c</p>
                                <select id="transfer-admin-select" class="form-control">
                                    <option value="">Ch·ªçn th√†nh vi√™n...</option>
                                </select>
                                <button type="button" id="transfer-admin-btn" class="btn btn-warning" disabled>
                                    <i class="fas fa-crown"></i> Chuy·ªÉn quy·ªÅn admin
                                </button>
                            </div>

                            <div class="action-group danger-zone">
                                <h5>R·ªùi nh√≥m</h5>
                                <p class="help-text">B·∫°n s·∫Ω kh√¥ng th·ªÉ xem tin nh·∫Øn v√† tham gia cu·ªôc tr√≤ chuy·ªán n√†y n·ªØa
                                </p>
                                <button type="button" id="leave-group-btn" class="btn btn-danger">
                                    <i class="fas fa-sign-out-alt"></i> R·ªùi nh√≥m
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary"
                            onclick="UI.hideModal('conversation-settings-modal')">
                            <i class="fas fa-times"></i> H·ªßy
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> L∆∞u thay ƒë·ªïi
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Member Modal -->
    <div id="add-member-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Th√™m th√†nh vi√™n</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Ch·ªçn b·∫°n b√® ƒë·ªÉ th√™m v√†o cu·ªôc tr√≤ chuy·ªán</label>
                    <div id="available-friends" class="friends-list">
                        <!-- Available friends will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Group Modal -->
    <div id="create-group-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>T·∫°o nh√≥m m·ªõi</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="create-group-form">
                    <div class="form-group">
                        <label for="group-name">T√™n nh√≥m</label>
                        <input type="text" id="group-name" name="name" placeholder="Nh·∫≠p t√™n nh√≥m..." required>
                    </div>
                    <div class="form-group">
                        <label>Th√™m th√†nh vi√™n</label>
                        <div id="group-friends-list" class="friends-list">
                            <!-- Friends list with checkboxes will be loaded here -->
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary close-modal">H·ªßy</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> T·∫°o nh√≥m
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div id="user-profile-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Th√¥ng tin c√° nh√¢n</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Profile Info Tab -->
                <div class="profile-tabs">
                    <button class="profile-tab-btn active" data-tab="profile-info">
                        <i class="fas fa-user"></i> Th√¥ng tin
                    </button>
                    <button class="profile-tab-btn" data-tab="profile-password">
                        <i class="fas fa-lock"></i> ƒê·ªïi m·∫≠t kh·∫©u
                    </button>
                </div>

                <!-- Profile Information -->
                <div id="profile-info" class="profile-tab-content active">
                    <form id="profile-update-form">
                        <div class="form-group">
                            <label for="profile-username">T√™n ƒëƒÉng nh·∫≠p</label>
                            <input type="text" id="profile-username" name="username"
                                placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p m·ªõi..." required>
                        </div>
                        <div class="form-group">
                            <label for="profile-email">Email</label>
                            <input type="email" id="profile-email" name="email" placeholder="Nh·∫≠p email m·ªõi..."
                                required>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary close-modal">H·ªßy</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> C·∫≠p nh·∫≠t th√¥ng tin
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Password Change -->
                <div id="profile-password" class="profile-tab-content">
                    <form id="password-update-form">
                        <div class="form-group">
                            <label for="current-password">M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
                            <input type="password" id="current-password" name="current_password"
                                placeholder="Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i..." required>
                        </div>
                        <div class="form-group">
                            <label for="new-password">M·∫≠t kh·∫©u m·ªõi</label>
                            <input type="password" id="new-password" name="new_password"
                                placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi..." required>
                        </div>
                        <div class="form-group">
                            <label for="confirm-password">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
                            <input type="password" id="confirm-password" name="confirm_password"
                                placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi..." required>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary close-modal">H·ªßy</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-key"></i> ƒê·ªïi m·∫≠t kh·∫©u
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notifications" class="notifications"></div>

    <!-- Scripts -->
    <script src="/static/js/api.js"></script>
    <script src="/static/js/websocket.js"></script>
    <script src="/static/js/ui.js"></script>
    <script src="/static/js/app.js"></script>
</body>

</html>